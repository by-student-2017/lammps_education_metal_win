#-----------------------------------------------------------------------------------------
### Created by Eric N. Hahn  ###
### ericnhahn@gmail.com ###
### Diamond impact of single graphene sheet ###
### Version 0.3 ###
#-----------------------------------------------------------------------------------------

# === Setup the simulation ===
log log.Graphene_impact
echo screen
dimension  3
units           metal
atom_style      atomic
boundary p p p

region box block  -210 210 -240 240 -5 200 units lattice
create_box 1 box

lattice custom 2.4595 a1 1  0  0  a2 0 1.73203 0 &
 basis 0 0 0  &
 basis 0.5 0.16666666666666666 0 &
 basis 0.5 0.5 0 &
 basis 0 0.6666666666666666 0
region graphene block  -210 210 -240 240 0 0.1 units lattice
create_atoms 1 region graphene 

mass * 12.011

# === Define Interatomic Potential ===
pair_style airebo/morse 3.0
pair_coeff * * CH.airebo-m C

compute 3 all pe/atom
compute 4 all stress/atom NULL virial #note, ignores thermal contribution to stress

# === Run the simulation for equilibration ===
velocity all create 300.0 12345 dist gaussian
fix npt all npt temp 298 298 .5 x 0.0 0.0 .5 y 0.0 0.0 .5

thermo  10
thermo_style custom step pe ke etotal temp lx ly lz press atoms

dump eve all custom 25 dump.graphene_impact.* id type x y z vx vy vz c_3 c_4[1] c_4[2] c_4[3]

timestep 0.001

fix bp all balance 250 1 shift z 10 1

thermo_style custom step temp ke pe press vol

run 50

group graphene region graphene
variable ymn equal ylo+4
variable ymx equal yhi-4
variable xmn equal xlo+4
variable xmx equal xhi-4
region middle block ${xmn} ${xmx} ${ymn} ${ymx} -5 5 units box
group middle region middle
group edge subtract graphene middle
unfix npt

lattice diamond 3.567
region mobile sphere 0 0 150 30 units box
create_atoms 1 region mobile
group impactor region mobile

change_box all boundary p p s

# === Run the simulation for impact ===

reset_timestep 0
velocity edge set NULL NULL 0 sum no units box
fix sheet edge setforce NULL NULL 0.0
velocity impactor set 0.0 0.0 -20.0 sum yes units box   #20 A/ps = 2 km/s

fix nve all nve

timestep 0.002

run 20000

print "Job's done" 
#-----------------------------------------------------------------------------------------