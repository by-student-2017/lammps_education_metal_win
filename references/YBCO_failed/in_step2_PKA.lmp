#------------------ PKA simulation for YBCO ------------------

variable myT equal 80

# ------------------ INITIALIZATION --------------------------
units metal
boundary p p p
dimension 3
atom-style charge
atom-modify map hash

read-data YBCO_40_40_16.dat

# ------- select PKA atom, define boundary region --------------
variable PKAEnergy equal 10000 #units eV
variable PKAID equal 2 # ID of 2 is Ba atom
group    PKAatom id ${PKAID}
variable PKAmass equal mass[vPKAID]
variable dispx equal -xE${PKAID}]
variable dispy equal -y[${PKAID}]
variable dispz equal -zt${PKAID}]
displace_atoms all move ${dispx} ${dispy} ${dispz} units box
variable PKAVel equal&
                "sqrt(v_PKAEnergy*19296.823743/v_PKAmass)"
variable pkaVx equal 0
variable pkaVy equal 0
variable pkaVz equal "-v_PKAVel"
region inter block -72.000000 72.000000&
                   -72.400000 72.400000&
                   -89.520000 89.520000 units box
group interatom region inter
group outeratom subtract all interatom
compute interT interatom temp
compute outT outeratom temp

# ------------------ Force Field --------------------------



# ------------------ Plot energy/force vs. distance r ------
thermo 100
thermo_style custom step pe ke press lx ly lz temp pxx pyy pzz
minimize 1e-10 1e-10 5000 10000

# ------------- Relax. at Target Temp for 100 ps -----------
reset_timestep 0
timestep 0.001
velocity all create ${myT} 8636 mom yes
fix 1 all nvt temp ${myT} ${myT} 0.1
run 100000
unfix 1

# ------------------- PKA enxemble ---------------------------
fix 1 all nve
fix 2 outeratom temp/rescale 1 ${myT} ${myT} 2 1
fix 3 all dt/reset 1 1.0e-6 1.0e-3 0.05 units box

# Assign velocity to PKA atom
velocity PKAatom set ${pkaVx} ${pkaVy} ${pkaVz} units box

# Compute pka atom energy and all atom energies
compute pkaKinetic PKAatom ke/atom
compute KineticAll all ke/atom

dump 1 all custom 10000 cascade.data.* id&
                  type x y z c-KineticAll
# Run simulation for 30 ps to let cascade settle down
run 30000