# Sample program to calculate lattice parameters for pure alpha-Zr using MEAM

#-------------------- Initialization -----------------------------------------------------
clear
units metal
boundary p p p

#-------------------- Atom & Lattice description ----------------------------------------
atom_style atomic

lattice hcp 3.232
#lattice fcc 4.83 for zirconium hydride

# regions of sample
region box block 0 5 0 3 0 3
create_box   1 box
create_atoms 1 box

mass 1 91.224  # Zr
#mass 2 1.0079 # H (in case of hydrogen)

#-------------------- Force field --------------------------------------------------------
pair_style meam # For MEAM potential 
pair_coeff * * meam Zr H ZrH.meam Zr
#pair_coeff * * meam Zr H ZrH.meam Zr H # (For MEAM with hydrogen)

#-------------------- Settings -----------------------------------------------------------
neighbor 2.0 bin
neigh_modify delay 0 every 1

#-------------------- Energy Minimization ------------------------------------------------
# 0 [K], structure optimization
minimize 1.0e-6 1.0e-6 10000 10000

#-------------------- Settings -----------------------------------------------------------
reset_timestep 0

timestep 0.001 # 1 [fs]

compute    eng all pe/atom
compute eatoms all reduce sum c_eng

variable     teng equal "c_eatoms"
variable length_x equal "lx"
variable length_z equal "lz"
variable     ecoh equal "v_teng/v_natoms"

thermo 100
thermo_style custom step pe lx ly lz press pxx pyy pzz c_eatoms vol etotal

#---------- output file settings -------------------------
dump            d1 all cfg 100 cfg/run.*.cfg mass type xs ys zs id type vx vy vz fx fy fz
dump_modify     d1 element Zr
#---------------------------------------------------------

#-------------------- Calculate energy ----------------------------------------------------

fix 1 all nve

run 100

print "Total energy (eV) = ${teng};"
print "Number of atoms = ${natoms};"
print "Lattice constant, x (Angstoms) = ${length_x};"
print "Lattice constant, z (Angstoms) = ${length_z};"
print "Cohesive energy (eV) = ${ecoh};"

print "All done!"
#-------------------- End ----------------------------------------------------------------
