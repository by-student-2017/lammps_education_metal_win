# Monte Carlo relaxation of perturbed 3d lattice
clear

# ----- set these parameters ----- 
# make sure neigh skin > 2*deltamove

# ----- condition settings -----
variable        temp         index 298.0 # K

# -----other settings -----
variable        iter         equal 30000  # number of Monte Carlo moves
variable        deltamove    equal 0.1    # max size of MC move in one dimension
variable        seed         equal 582783 # RNG seed

# problem setup

# ----- Structure settings -----
units           metal
atom_style      atomic
atom_modify     map array sort 0 0.0
dimension       3
boundary        p p p
read_data       data_5x4x4.in
replicate       1 1 1

# ----- Potential settings (MEAM)-----
# -----HEA (Co-Ni-Cr-Fe-Mn)
pair_style      meam/c
pair_coeff      * * ./meam/CoNiCrFeMn.HEA.library.meam Co Ni Cr Fe Mn ./meam/CoNiCrFeMn.HEA.meam Co Ni Cr Fe Mn
# -----(Al-Si-Mg-Cu-Fe)
#pair_style      meam/c
#pair_coeff      * * ./meam/Jelinek_2012_meamf AlS SiS MgS CuS FeS ./meam/Jelinek_2012_meam.alsimgcufe AlS SiS MgS CuS FeS

neighbor        0.3 bin
neigh_modify    delay 0 every 1 check yes

# ----- Output setting -----
thermo_style    custom step etotal temp lx vol press
thermo          100
variable        energy equal etotal
variable        temperature equal temp
fix             fout1 all ave/time 1 100 100 v_energy v_temperature file out_energy.txt
dump            d1 all cfg 100 cfg/run.*.cfg mass type xs ys zs id type
dump_modify     d1 element Co Ni Cr Fe Mn # Co-Ni-Cr-Fe-Mn
#dump_modify     d1 element Al Si Mg Cu Fe  # Al-Si-Mg-Cu-Fe

#dump           1 all atom 25 dump.mc

#dump           2 all image 25 image.*.jpg type type &
#               zoom 1.6 adiam 1.0
#dump_modify    2 pad 5

#dump           3 all movie 25 movie.mpg type type &
#               zoom 1.6 adiam 1.0
#dump_modify    3 pad 5

# ----- tfMC calculation ----- 
velocity        all create ${temp} ${seed}
fix             f1 all tfmc ${deltamove} ${temp} ${seed} com 1 1 1 rot
run             ${iter}
unfix           f1
unfix           fout1

# ----- Output restart data -----
write_data data.in.restart